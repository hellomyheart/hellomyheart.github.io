(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{478:function(t,s,a){"use strict";a.r(s);var e=a(14),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("哈希算法（Hash）又称摘要算法（Digest），它的作用是：对任意一组输入数据进行计算，得到一个固定长度的输出摘要。")]),t._v(" "),a("p",[t._v("哈希算法最重要的特点就是：")]),t._v(" "),a("ul",[a("li",[t._v("相同的输入一定得到相同的输出；")]),t._v(" "),a("li",[t._v("不同的输入大概率得到不同的输出。")])]),t._v(" "),a("p",[t._v("哈希算法的目的就是为了验证原始数据是否被篡改。")]),t._v(" "),a("p",[t._v("Java字符串的"),a("code",[t._v("hashCode()")]),t._v("就是一个哈希算法，它的输入是任意字符串，输出是固定的4字节"),a("code",[t._v("int")]),t._v("整数：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"hello".hashCode(); // 0x5e918d2\n"hello, java".hashCode(); // 0x7a9d88e8\n"hello, bob".hashCode(); // 0xa0dbae2f\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("两个相同的字符串永远会计算出相同的"),a("code",[t._v("hashCode")]),t._v("，否则基于"),a("code",[t._v("hashCode")]),t._v("定位的"),a("code",[t._v("HashMap")]),t._v("就无法正常工作。这也是为什么当我们自定义一个class时，覆写"),a("code",[t._v("equals()")]),t._v("方法时我们必须正确覆写"),a("code",[t._v("hashCode()")]),t._v("方法。")]),t._v(" "),a("h3",{attrs:{id:"哈希碰撞"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#哈希碰撞"}},[t._v("#")]),t._v(" 哈希碰撞")]),t._v(" "),a("p",[t._v("哈希碰撞是指，两个不同的输入得到了相同的输出：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"AaAaAa".hashCode(); // 0x7460e8c0\n"BBAaBB".hashCode(); // 0x7460e8c0\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("有童鞋会问：碰撞能不能避免？答案是不能。碰撞是一定会出现的，因为输出的字节长度是固定的，"),a("code",[t._v("String")]),t._v("的"),a("code",[t._v("hashCode()")]),t._v("输出是4字节整数，最多只有4294967296种输出，但输入的数据长度是不固定的，有无数种输入。所以，哈希算法是把一个无限的输入集合映射到一个有限的输出集合，必然会产生碰撞。")]),t._v(" "),a("p",[t._v("碰撞不可怕，我们担心的不是碰撞，而是碰撞的概率，因为碰撞概率的高低关系到哈希算法的安全性。一个安全的哈希算法必须满足：")]),t._v(" "),a("ul",[a("li",[t._v("碰撞概率低；")]),t._v(" "),a("li",[t._v("不能猜测输出。")])]),t._v(" "),a("p",[t._v("不能猜测输出是指，输入的任意一个bit的变化会造成输出完全不同，这样就很难从输出反推输入（只能依靠暴力穷举）。假设一种哈希算法有如下规律：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('hashA("java001") = "123456"\nhashA("java002") = "123457"\nhashA("java003") = "123458"\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("那么很容易从输出"),a("code",[t._v("123459")]),t._v("反推输入，这种哈希算法就不安全。安全的哈希算法从输出是看不出任何规律的：")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('hashB("java001") = "123456"\nhashB("java002") = "580271"\nhashB("java003") = ???\n')])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("常用的哈希算法有：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("算法")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("输出长度（位）")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("输出长度（字节）")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("MD5")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("128 bits")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("16 bytes")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SHA-1")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("160 bits")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("20 bytes")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("RipeMD-160")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("160 bits")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("20 bytes")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SHA-256")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("256 bits")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("32 bytes")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("SHA-512")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("512 bits")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("64 bytes")])])])]),t._v(" "),a("p",[t._v("根据碰撞概率，哈希算法的输出长度越长，就越难产生碰撞，也就越安全。")]),t._v(" "),a("p",[t._v("Java标准库提供了常用的哈希算法，并且有一套统一的接口。我们以MD5算法为例，看看如何对输入计算哈希：")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("security"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Main")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建一个MessageDigest实例:")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),t._v(" md "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MD5"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 反复调用update输入数据:")]),t._v("\n        md"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        md"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"World"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" md"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 16 bytes: 68e109f0f40ca72a15e05cc22786f8e6")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("使用"),a("code",[t._v("MessageDigest")]),t._v("时，我们首先根据哈希算法获取一个"),a("code",[t._v("MessageDigest")]),t._v("实例，然后，反复调用"),a("code",[t._v("update(byte[])")]),t._v("输入数据。当输入结束后，调用"),a("code",[t._v("digest()")]),t._v("方法获得byte[]数组表示的摘要，最后，把它转换为十六进制的字符串。")]),t._v(" "),a("p",[t._v("运行上述代码，可以得到输入"),a("code",[t._v("HelloWorld")]),t._v("的MD5是"),a("code",[t._v("68e109f0f40ca72a15e05cc22786f8e6")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"哈希算法的用途"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#哈希算法的用途"}},[t._v("#")]),t._v(" 哈希算法的用途")]),t._v(" "),a("p",[t._v("因为相同的输入永远会得到相同的输出，因此，如果输入被修改了，得到的输出就会不同。")]),t._v(" "),a("p",[t._v("我们在网站上下载软件的时候，经常看到下载页显示的哈希：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://zeroone-bucket.oss-cn-beijing.aliyuncs.com/blog/20210409091511.jpeg",alt:"file-md5"}})]),t._v(" "),a("p",[t._v("如何判断下载到本地的软件是原始的、未经篡改的文件？我们只需要自己计算一下本地文件的哈希值，再与官网公开的哈希值对比，如果相同，说明文件下载正确，否则，说明文件已被篡改。")]),t._v(" "),a("p",[t._v("哈希算法的另一个重要用途是存储用户口令。如果直接将用户的原始口令存放到数据库中，会产生极大的安全风险：")]),t._v(" "),a("ul",[a("li",[t._v("数据库管理员能够看到用户明文口令；")]),t._v(" "),a("li",[t._v("数据库数据一旦泄漏，黑客即可获取用户明文口令。")])]),t._v(" "),a("p",[t._v("不存储用户的原始口令，那么如何对用户进行认证？")]),t._v(" "),a("p",[t._v("方法是存储用户口令的哈希，例如，MD5。")]),t._v(" "),a("p",[t._v("在用户输入原始口令后，系统计算用户输入的原始口令的MD5并与数据库存储的MD5对比，如果一致，说明口令正确，否则，口令错误。")]),t._v(" "),a("p",[t._v("因此，数据库存储用户名和口令的表内容应该像下面这样：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("username")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("password")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bob")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("f30aa7a662c728b7407c54ae6bfd27d1")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("alice")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("25d55ad283aa400af464c76d713c07ad")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("tim")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bed128365216c019988915ed3add75fb")])])])]),t._v(" "),a("p",[t._v("这样一来，数据库管理员看不到用户的原始口令。即使数据库泄漏，黑客也无法拿到用户的原始口令。想要拿到用户的原始口令，必须用暴力穷举的方法，一个口令一个口令地试，直到某个口令计算的MD5恰好等于指定值。")]),t._v(" "),a("p",[t._v("使用哈希口令时，还要注意防止彩虹表攻击。")]),t._v(" "),a("p",[t._v("什么是彩虹表呢？上面讲到了，如果只拿到MD5，从MD5反推明文口令，只能使用暴力穷举的方法。")]),t._v(" "),a("p",[t._v("然而黑客并不笨，暴力穷举会消耗大量的算力和时间。但是，如果有一个预先计算好的常用口令和它们的MD5的对照表：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("常用口令")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("MD5")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("hello123")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("f30aa7a662c728b7407c54ae6bfd27d1")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("12345678")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("25d55ad283aa400af464c76d713c07ad")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("passw0rd")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("bed128365216c019988915ed3add75fb")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("19700101")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("570da6d5277a646f6552b8832012f5dc")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("…")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("…")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("20201231")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("6879c0ae9117b50074ce0a0d4c843060")])])])]),t._v(" "),a("p",[t._v("这个表就是彩虹表。如果用户使用了常用口令，黑客从MD5一下就能反查到原始口令：")]),t._v(" "),a("p",[t._v("bob的MD5："),a("code",[t._v("f30aa7a662c728b7407c54ae6bfd27d1")]),t._v("，原始口令："),a("code",[t._v("hello123")]),t._v("；")]),t._v(" "),a("p",[t._v("alice的MD5："),a("code",[t._v("25d55ad283aa400af464c76d713c07ad")]),t._v("，原始口令："),a("code",[t._v("12345678")]),t._v("；")]),t._v(" "),a("p",[t._v("tim的MD5："),a("code",[t._v("bed128365216c019988915ed3add75fb")]),t._v("，原始口令："),a("code",[t._v("passw0rd")]),t._v("。")]),t._v(" "),a("p",[t._v("这就是为什么不要使用常用密码，以及不要使用生日作为密码的原因。")]),t._v(" "),a("p",[t._v("即使用户使用了常用口令，我们也可以采取措施来抵御彩虹表攻击，方法是对每个口令额外添加随机数，这个方法称之为加盐（salt）：")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("digest "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("md5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("salt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("inputPassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("经过加盐处理的数据库表，内容如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("username")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("salt")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("password")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bob")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("H1r0a")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("a5022319ff4c56955e22a74abcc2c210")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("alice")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("7$p2w")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("e5de688c99e961ed6e560b972dab8b6a")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("tim")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("z5Sk9")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("1eee304b92dc0d105904e7ab58fd2f64")])])])]),t._v(" "),a("p",[t._v("加盐的目的在于使黑客的彩虹表失效，即使用户使用常用口令，也无法从MD5反推原始口令。")]),t._v(" "),a("h3",{attrs:{id:"sha-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sha-1"}},[t._v("#")]),t._v(" SHA-1")]),t._v(" "),a("p",[t._v("SHA-1也是一种哈希算法，它的输出是160 bits，即20字节。SHA-1是由美国国家安全局开发的，SHA算法实际上是一个系列，包括SHA-0（已废弃）、SHA-1、SHA-256、SHA-512等。")]),t._v(" "),a("p",[t._v("在Java中使用SHA-1，和MD5完全一样，只需要把算法名称改为"),a("code",[t._v('"SHA-1"')]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("security"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Main")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建一个MessageDigest实例:")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),t._v(" md "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SHA-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 反复调用update输入数据:")]),t._v("\n        md"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        md"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"World"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UTF-8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" md"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 20 bytes: db8ac1c259eb89d4a131b253bacfca5f319d54f2")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BigInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("类似的，计算SHA-256，我们需要传入名称"),a("code",[t._v('"SHA-256"')]),t._v("，计算SHA-512，我们需要传入名称"),a("code",[t._v('"SHA-512"')]),t._v("。Java标准库支持的所有哈希算法可以在"),a("a",{attrs:{href:"https://docs.oracle.com/en/java/javase/14/docs/specs/security/standard-names.html#messagedigest-algorithms",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),a("OutboundLink")],1),t._v("查到。")]),t._v(" "),a("p",[t._v("注意：MD5因为输出长度较短，短时间内破解是可能的，目前已经不推荐使用。")]),t._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[t._v("#")]),t._v(" 小结")]),t._v(" "),a("p",[t._v("哈希算法可用于验证数据完整性，具有防篡改检测的功能；")]),t._v(" "),a("p",[t._v("常用的哈希算法有MD5、SHA-1等；")]),t._v(" "),a("p",[t._v("用哈希存储口令时要考虑彩虹表攻击。")])])}),[],!1,null,null,null);s.default=n.exports}}]);