(window.webpackJsonp=window.webpackJsonp||[]).push([[577],{993:function(s,a,t){"use strict";t.r(a);var e=t(14),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"数据库方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库方法"}},[s._v("#")]),s._v(" 数据库方法")]),s._v(" "),t("p",[s._v("以下方法可用于通过JavaScript管理数据库。请注意，只能从_system数据库使用这些方法中的几种。")]),s._v(" "),t("h3",{attrs:{id:"名称"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#名称"}},[s._v("#")]),s._v(" 名称")]),s._v(" "),t("p",[s._v("返回数据库名称 "),t("code",[s._v("db._name()")])]),s._v(" "),t("p",[s._v("以字符串形式返回当前数据库的名称。")]),s._v(" "),t("p",[t("strong",[s._v("例子")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("arangosh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" require（“ @arangodb”）.db._name（）"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n_system\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#id"}},[s._v("#")]),s._v(" ID")]),s._v(" "),t("p",[s._v("返回数据库ID "),t("code",[s._v("db._id()")])]),s._v(" "),t("p",[s._v("以字符串形式返回当前数据库的ID。")]),s._v(" "),t("p",[t("strong",[s._v("例子")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("arangosh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" require（“ @arangodb”）.db._id（）"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"路径"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#路径"}},[s._v("#")]),s._v(" 路径")]),s._v(" "),t("p",[s._v("返回数据库文件的路径 "),t("code",[s._v("db._path()")])]),s._v(" "),t("p",[s._v("以字符串形式返回当前数据库的文件系统路径。")]),s._v(" "),t("p",[t("strong",[s._v("例子")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("arangosh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" require（“ @arangodb”）.db._path（）"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nnone\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"数据库类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据库类型"}},[s._v("#")]),s._v(" 数据库类型")]),s._v(" "),t("p",[s._v("返回数据库类型 "),t("code",[s._v("db._isSystem()")])]),s._v(" "),t("p",[s._v("返回当前使用的数据库是否为*_system"),t("em",[s._v("数据库。系统数据库具有一些特殊的特权和属性，例如，只能在此数据库内执行数据库管理操作（例如创建或删除）。此外，不能删除")]),s._v("_system*数据库本身。")]),s._v(" "),t("h3",{attrs:{id:"特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[s._v("#")]),s._v(" 特性")]),s._v(" "),t("p",[s._v("返回数据库文件的路径 "),t("code",[s._v("db._properties()")])]),s._v(" "),t("p",[s._v("以具有以下属性的对象的形式返回当前数据库的属性：")]),s._v(" "),t("ul",[t("li",[t("em",[s._v("id")]),s._v("：数据库ID")]),s._v(" "),t("li",[t("em",[s._v("name")]),s._v("：数据库名称")]),s._v(" "),t("li",[t("em",[s._v("isSystem")]),s._v("：数据库类型")]),s._v(" "),t("li",[t("em",[s._v("path")]),s._v("：数据库文件的路径")]),s._v(" "),t("li",[t("strong",[s._v("sharding")]),s._v("：用于新集合的分片方法*（仅"),t("em",[s._v("适用于")]),s._v("集群）*")]),s._v(" "),t("li",[t("em",[s._v("ReplicationFactor")]),s._v("：新集合的默认复制因子*（仅*适用于 "),t("em",[s._v("集群）")])]),s._v(" "),t("li",[t("em",[s._v("writeConcern")]),s._v("：如果同步的副本数少于此数量，则分片将拒绝写入*（仅适用"),t("em",[s._v("于")]),s._v("集群）*")])]),s._v(" "),t("p",[t("strong",[s._v("例子")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("arangosh> require（“ @arangodb”）.db._properties（）;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"id"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_system"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"isSystem"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"sharding"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"replicationFactor"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"writeConcern"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"path"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"使用数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用数据库"}},[s._v("#")]),s._v(" 使用数据库")]),s._v(" "),t("p",[s._v("更改当前数据库 "),t("code",[s._v("db._useDatabase(name)")])]),s._v(" "),t("p",[s._v("将当前数据库更改为"),t("em",[s._v("name")]),s._v("指定的数据库。请注意，按"),t("em",[s._v("名称")]),s._v("指定的数据库必须已经存在。")]),s._v(" "),t("p",[s._v("在某些情况下，例如服务器端操作（包括Foxx），可能不允许更改数据库。")]),s._v(" "),t("p",[s._v("从arangosh执行此命令时，将重新使用当前凭据（用户名和密码）。这些凭据可能无效，无法连接到"),t("em",[s._v("name")]),s._v("指定的数据库。此外，只能从某些端点访问数据库。在这种情况下，切换数据库可能不起作用，并且应该使用不同的用户名和密码凭据和/或终结点数据关闭并重新启动连接/会话。")]),s._v(" "),t("h3",{attrs:{id:"列出数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#列出数据库"}},[s._v("#")]),s._v(" 列出数据库")]),s._v(" "),t("p",[s._v("返回所有现有数据库的列表 "),t("code",[s._v("db._databases()")])]),s._v(" "),t("p",[s._v("返回所有数据库的列表。此方法只能在*_system*数据库中使用。")]),s._v(" "),t("h3",{attrs:{id:"创建数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库"}},[s._v("#")]),s._v(" 创建数据库")]),s._v(" "),t("p",[s._v("创建一个新的数据库 "),t("code",[s._v("db._createDatabase(name, options, users)")])]),s._v(" "),t("p",[s._v("用name指定的"),t("em",[s._v("名称")]),s._v("创建一个新数据库。数据库名称有限制（请参见"),t("a",{attrs:{href:"https://www.arangodb.com/docs/devel/data-modeling-naming-conventions-database-names.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("DatabaseNames"),t("OutboundLink")],1),s._v("）。")]),s._v(" "),t("p",[s._v("请注意，即使数据库创建成功，当前数据库也不会更改为新数据库。必须使用"),t("em",[s._v("db._useDatabase")]),s._v("方法显式请求更改当前数据库 。")]),s._v(" "),t("p",[s._v("该"),t("em",[s._v("options")]),s._v("属性可以用来设置默认值，将在新的数据库中创建集合（"),t("em",[s._v("集群中使用")]),s._v("）：")]),s._v(" "),t("ul",[t("li",[s._v("*"),t("em",[s._v("sharding")]),s._v("：使用的分片方法。有效值为："),t("code",[s._v('""')]),s._v("或"),t("code",[s._v('"single"')]),s._v("。将此选项设置为"),t("code",[s._v('"single"')]),s._v("将会启用企业版中的OneShard功能。")]),s._v(" "),t("li",[t("em",[s._v("replicationFactor")]),s._v("：默认复制因子。特殊值包括 "),t("code",[s._v('"satellite"')]),s._v("，它将复制集合到每个DB-Server，和 "),t("code",[s._v("1")]),s._v("禁用复制。")]),s._v(" "),t("li",[t("em",[s._v("writeConcern")]),s._v("：每个分片需要在不同的DB服务器上同步多少个副本。如果集群中的副本数量少于这些副本，则分片将拒绝写入。"),t("em",[s._v("writeConcern")]),s._v("的值不能大于"),t("em",[s._v("ReplicationFactor")]),s._v("。")])]),s._v(" "),t("p",[s._v("可选的"),t("em",[s._v("users")]),s._v("属性可用于为新数据库创建初始用户。如果指定，它必须是用户对象的列表。每个用户对象可以包含以下属性：")]),s._v(" "),t("ul",[t("li",[t("em",[s._v("username")]),s._v("：用户名（字符串）。此属性是必需的。")]),s._v(" "),t("li",[t("em",[s._v("passwd")]),s._v("：用户密码（字符串）。如果未指定，则默认为空字符串。")]),s._v(" "),t("li",[t("em",[s._v("active")]),s._v("：一个布尔型标志，指示用户帐户是否应该处于活动状态。默认值为"),t("em",[s._v("true")]),s._v("。")]),s._v(" "),t("li",[t("em",[s._v("extra")]),s._v("：一个带有额外用户信息的可选JSON对象。包含在"),t("em",[s._v("extra中")]),s._v("的数据将为用户存储，但ArangoDB不会进一步解释。")])]),s._v(" "),t("p",[s._v("如果未指定初始用户，则将使用空字符串密码创建默认用户"),t("em",[s._v("root")]),s._v("。这样可以确保新数据库在创建后将可通过HTTP访问。")]),s._v(" "),t("p",[s._v("如果未指定初始用户，则可以在数据库中创建用户。切换到新数据库（用户名和密码必须与当前会话相同），并使用以下命令添加或修改用户。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("require"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@arangodb/users"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".save"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username, password, "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nrequire"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@arangodb/users"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".update"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username, password, "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nrequire"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@arangodb/users"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".remove"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("或者，您可以直接指定用户数据。例如：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("db._createDatabase"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"newDB"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" username: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"newUser"')]),s._v(", passwd: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(", active: true"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这些方法只能在*_system*数据库中使用。")]),s._v(" "),t("h3",{attrs:{id:"删除数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除数据库"}},[s._v("#")]),s._v(" 删除数据库")]),s._v(" "),t("p",[s._v("删除现有数据库 "),t("code",[s._v("db._dropDatabase(name)")])]),s._v(" "),t("p",[s._v("删除由"),t("em",[s._v("name")]),s._v("指定的数据库。通过"),t("em",[s._v("名称")]),s._v("指定的数据库 必须存在。")]),s._v(" "),t("p",[t("strong",[s._v("注意")]),s._v("：只能从*_system* 数据库中"),t("em",[s._v("删除")]),s._v("数据库。该*_SYSTEM*数据库本身不能被丢弃。")]),s._v(" "),t("p",[s._v("数据库是异步删除的，如果所有客户端都已断开连接并且引用已被垃圾回收，则将物理删除数据库。")]),s._v(" "),t("h3",{attrs:{id:"压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#压缩"}},[s._v("#")]),s._v(" 压缩")]),s._v(" "),t("p",[s._v("引入于：v3.5.6，v3.6.7，v3.7.3")]),s._v(" "),t("p",[s._v("压缩所有数据库的全部数据 "),t("code",[s._v("db._compact(options)")])]),s._v(" "),t("p",[s._v("删除大量数据后，可以使用此命令来回收磁盘空间。它需要超级用户访问权限。")]),s._v(" "),t("p",[s._v("可选的"),t("em",[s._v("options")]),s._v("属性可用于获得对压缩的更多控制。可以在其中使用以下属性：")]),s._v(" "),t("ul",[t("li",[t("em",[s._v("changeLevel")]),s._v("：是否应将压缩数据移动到最小可能的级别。默认值为"),t("em",[s._v("false")]),s._v("。")]),s._v(" "),t("li",[t("em",[s._v("compactBottomMostLevel")]),s._v("：是否压缩最底层的数据。默认值为"),t("em",[s._v("false")]),s._v("。")])]),s._v(" "),t("p",[s._v("此命令可能导致所有数据库中的所有数据被完全重写，这对于大型数据库可能会花费很长时间。因此，只有在可以长时间忍受额外的I / O负载的情况下，才应谨慎使用它。")]),s._v(" "),t("h3",{attrs:{id:"引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#引擎"}},[s._v("#")]),s._v(" 引擎")]),s._v(" "),t("p",[s._v("检索服务器使用的存储引擎类型 "),t("code",[s._v("db._engine()")])]),s._v(" "),t("p",[s._v("返回正在使用的存储引擎的名称（"),t("code",[s._v("mmfiles")]),s._v("或"),t("code",[s._v("rocksdb")]),s._v("），以及所支持功能的列表，例如索引类型。")]),s._v(" "),t("h3",{attrs:{id:"引擎统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#引擎统计"}},[s._v("#")]),s._v(" 引擎统计")]),s._v(" "),t("p",[s._v("检索与存储引擎有关的统计信息 "),t("code",[s._v("db._engineStats()")])]),s._v(" "),t("p",[s._v("返回与存储引擎活动有关的一些统计信息，包括有关数据大小，缓存使用情况等的数字。")]),s._v(" "),t("h2",{attrs:{id:"获取arangodb的版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取arangodb的版本"}},[s._v("#")]),s._v(" 获取ArangoDB的版本")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("db._version()\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("返回服务器版本字符串。请注意，这不是数据库的版本。")]),s._v(" "),t("p",[t("strong",[s._v("例子")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("arangosh> require（“ @arangodb”）.db._version（）;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);